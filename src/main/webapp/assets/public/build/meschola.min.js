/*! meschola 2016-03-11 */
angular.module("smiled.application").factory("apiService",["$http","$q","Restangular",function(a,b,c){function d(a){return e.post("",a)}var e=c.one("register"),f=function(c){var d=b.defer();return a.get("/api/v1/scenarios/"+c).then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},g=function(c){var d=b.defer();return a.post("/api/v1/scenarios",c).then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},h=function(c,d){var e=b.defer();return a.put("/api/v1/scenarios/"+d,c).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},i=function(c){var d=b.defer();return a["delete"]("/api/v1/scenarios/"+c).then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},j=function(c,d){var e=b.defer();return a.post("/api/v1/scenarios/"+d+"/users",c).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},k=function(c,d){var e=b.defer();return a.post("/api/v1/scenarios/"+d+"/collaborators/"+c).then(function(a){e.resolve(a.data)},function(a){console.log(a),e.reject(a)}),e.promise},l=function(c,d){var e=b.defer();return a.post("/api/v1/scenarios/"+d+"/characters",c).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},m=function(c,d,e){var f=b.defer();return a.put("/api/v1/scenarios/"+c+"/characters/"+e,d).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},n=function(c){var d=b.defer();return a.get("/api/v1/scenarios/"+c+"/characters").then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},o=function(c,d){var e=b.defer();return a.get("/api/v1/scenarios/"+c+"/characters/"+d).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},p=function(c,d){var e=b.defer();return a["delete"]("/api/v1/scenarios/"+c+"/users/"+d).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},q=function(c,d,e){var f=b.defer();return a["delete"]("/api/v1/scenarios/"+c+"/collaborators/"+d,e).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},r=function(c,d){var e=b.defer();return a["delete"]("/api/v1/scenarios/"+c+"/characters/"+d).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},s=function(c,d,e){var f=b.defer();return a.put("/api/v1/scenarios/"+c+"/characters/"+e+"/users/"+d).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},t=function(c,d,e){var f=b.defer();return a["delete"]("/api/v1/scenarios/"+c+"/characters/"+e+"/users/"+d).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},u=function(c,d,e){var f=b.defer();return a.post("/api/v1/scenarios/"+c+"/characters/"+d+"/status",e).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},v=function(c,d,e){var f=b.defer();return a.put("/api/v1/scenarios/"+c+"/status/"+d,e).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},w=function(c,d,e){var f=b.defer();return a.put("/api/v1/scenarios/"+c+"/events/"+d,e).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},x=function(c,d){var e=b.defer();return a["delete"]("/api/v1/scenarios/"+c+"/posts/"+d).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},y=function(c,d,e,f,g){"undefined"==typeof g&&(g=!0);var h=b.defer();return a.get("/api/v1/scenarios/"+c+"/posts",{params:{nPag:d,nItem:e,historicOrder:f,orderDesc:g}}).then(function(a){h.resolve(a.data)},function(a){h.reject(a)}),h.promise},z=function(c,d,e){var f=b.defer();return a.get("/api/v1/scenarios/"+c+"/posts",{params:{last:d,nItem:e}}).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},A=function(c,d,e,f,g){var h=!1;"undefined"==typeof f&&(h=!0);var i=b.defer();return h?a.get("/api/v1/scenarios/"+c+"/historic-posts",{params:{nItem:d,orderDesc:e}}).then(function(a){i.resolve(a.data)},function(a){i.reject(a)}):a.get("/api/v1/scenarios/"+c+"/historic-posts",{params:{nItem:d,orderDesc:e,date:f,time:g}}).then(function(a){i.resolve(a.data)},function(a){i.reject(a)}),i.promise},B=function(c,d,e,f,g){var h=!1;"undefined"==typeof f&&(h=!0);var i=b.defer();return h?a.get("/api/v1/scenarios/"+c+"/characters/"+d+"/posts",{params:{nItem:e}}).then(function(a){i.resolve(a.data)},function(a){i.reject(a)}):a.get("/api/v1/scenarios/"+c+"/characters/"+d+"/posts",{params:{nItem:e,date:f,time:g}}).then(function(a){i.resolve(a.data)},function(a){i.reject(a)}),i.promise},C=function(c,d){var e=b.defer();return a.post("/api/v1/scenarios/"+c+"/newPosts",d).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},D=function(c,d){var e=b.defer();return a.get("/api/v1/getPagedRegistrationRequests",{params:{nPag:c,nItem:d}}).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},E=function(c,d){var e=b.defer();return a.get("/api/v1/log",{params:{nPag:c,nItem:d}}).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},F=function(c,d){var e=b.defer();return a.get("/api/v1/issues",{params:{nPag:c,nItem:d}}).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},G=function(c,d){var e=b.defer();return a.get("/api/v1/suggestions",{params:{nPag:c,nItem:d}}).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},H=function(c,d){var e=b.defer();return a.get("/api/v1/userScenarios",{params:{firstName:c,lastName:d}}).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},I=function(c,d){var e=b.defer();return a.get("/api/v1/teachers",{params:{nPag:c,nItem:d}}).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},J=function(c,d){var e=b.defer();return a.get("/api/v1/students",{params:{nPag:c,nItem:d}}).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},K=function(c,d,e){var f=b.defer();return a.get("/api/v1/scenarios",{params:{nPag:c,nItem:d,orderByCreation:e}}).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},L=function(c,d){var e=b.defer();return a.get("/api/v1/clientException",{params:{nPag:c,nItem:d}}).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},M=function(c,d,e){var f=b.defer();return a.get("/api/v1/searchTeachers",{params:{regex:e,nPag:c,nItem:d}}).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},N=function(c,d){var e=b.defer();return a.get("/api/v1/scenarios/"+c+"/posts/"+d).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},O=function(c,d){var e=b.defer();return a.post("/api/v1/scenarios/"+c+"/posts/"+d+"/likes").then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},P=function(c,d,e){var f=b.defer();return a.post("/api/v1/scenarios/"+c+"/posts/"+d+"/comments",e).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},Q=function(c,d,e){var f=b.defer();return a.post("/api/v1/scenarios/"+c+"/posts/"+d+"/metaComments",e).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},R=function(c,d){var e=b.defer();return a.post("/api/v1/scenarios/"+c+"/events",d).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},S=function(c){var d=b.defer();return a.post("/api/v1/report",c).then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},T=function(c){var d=b.defer();return a.post("/api/v1/suggestion",c).then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},U=function(c,d){var e=b.defer();return a.put("/api/v1/scenarios/"+c+"/mission",d).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},V=function(c){var d=b.defer();return a["delete"]("/api/v1/scenarios/"+c+"/mission").then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},W=function(c,d,e){var f=b.defer();return a.put("/api/v1/scenarios/"+c+"/characters/"+d+"/mission",e).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},X=function(c,d){var e=b.defer();return a["delete"]("/api/v1/scenarios/"+c+"/characters/"+d+"/mission").then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},Y=function(c,d,e){var f=b.defer();return a.put("/api/v1/scenarios/"+c+"/media/"+d+"/meta",e).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},Z=function(c){var d=b.defer();return a.get("/api/v1/scenarios/"+c+"/media/trusted/meta").then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},Y=function(c,d,e){var f=b.defer();return a.put("/api/v1/scenarios/"+c+"/media/"+d+"/meta",e).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},Z=function(c){var d=b.defer();return a.get("/api/v1/scenarios/"+c+"/media/trusted/meta").then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},$=function(){var c=b.defer();return a.get("/api/v1/missions").then(function(a){c.resolve(a.data)},function(a){c.reject(a)}),c.promise},_=function(c){var d,e=b.defer();return d=c?"/api/v1/draft?preview=true":"/api/v1/draft",a.get(d).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},aa=function(c,d){var e=b.defer();return a["delete"]("/api/v1/scenarios/"+c+"/trustedMedia/"+d).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},ba=function(c,d){var e,f=b.defer();return e=d?"/api/v1/me/media/"+c+"?postId="+d:"/api/v1/me/media/"+c,a["delete"](e).then(function(a){f.resolve(a.data)},function(a){f.reject(a)}),f.promise},ca=function(c,d){var e=b.defer(),f="api/v1/lastNotifications?num="+d+"&old="+c;return a.get(f).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise};return{postRegister:d,createScenario:g,getScenario:f,updateScenario:h,addUsersToScenario:j,removeUserFromScenario:p,addCollaboratorToScenario:k,removeCollaboratorFromScenario:q,addCharacterToScenario:l,updateCharacter:m,getCharacter:o,deleteScenario:i,removeCharacterFromScenario:r,getAllCharactersFromScen:n,addUserToCharacter:s,removeUserFromCharacter:t,getPagedTeacherByRegex:M,sendStatus:u,updateStatus:v,deletePost:x,getPagedPosts:y,getPagedIssues:F,getPagedSuggestions:G,getSingleStatus:N,addLikeToPost:O,sendCommentToPost:P,sendMetaCommentToPost:Q,sendEvent:R,addMissionToScenario:U,addMissionToCharacter:W,deleteMissionToScenario:V,deleteMissionToCharacter:X,postIssue:S,postSuggestion:T,getPagedStudents:J,getPagedTeachers:I,getPagedScenarios:K,getUsersByFirstNameAndLastName:H,updateEvent:w,getPagedExceptions:L,getPagedLogs:E,getPagedRegistrationRequests:D,postTrustedMediaMetadata:Y,getTrustedMediaMetadata:Z,deleteTrustedMedia:aa,getMyMissions:$,getMyDraft:_,deleteMedia:ba,getListOfNewPosts:C,getLastUserNotifications:ca,getLastPosts:z,getLastHistoricPosts:A,getLastCharacterPosts:B}}]),angular.module("smiled.application").factory("userService",["$http","$q","$cookies","$rootScope",function(a,b,c,d){var e="",f={},g=function(a){e=a},h=function(){return e},i=function(){return f},j=function(){var e=b.defer();return a.get("/api/v1/me").then(function(a){e.resolve(a.data),c.put("myMescholaId",a.data.id),f=a.data,d.$broadcast("meschola.login",{id:a.data.id})},function(a){e.reject(a),f={}}),e.promise},k=function(c){var d=b.defer();return a.get("/api/v1/userByEmail?email="+c).then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},l=function(c,d){var e=b.defer();return a.put("/api/v1/confirmRegisterTeacher?token="+c+"&email="+d).then(function(a){e.resolve(a.data)},function(a){console.log(a),e.reject(a)}),e.promise},m=function(c,d){var e=b.defer();return a["delete"]("/api/v1/deleteRegisterTeacher?token="+c+"&email="+d).then(function(a){e.resolve(a.data)},function(a){console.log(a),e.reject(a)}),e.promise},n=function(c){var d=b.defer();return a.get("/api/v1/users/"+c).then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},o=function(c){var d=b.defer();return a.put("/api/v1/me/",c).then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},p=function(){var e=b.defer();return a({url:"/apiLogout",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(a){f={},c.remove("myMescholaId"),e.resolve(a),d.$broadcast("meschola.logout")},function(a){console.log("Logout failed: "+a),e.reject(a)}),e.promise},q=function(c,d){var e=b.defer(),f=encodeURIComponent(c),g=encodeURIComponent(d);return a({url:"/apiLogin",method:"POST",data:"j_username="+f+"&j_password="+g+"&submit=",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(a){e.resolve(a)},function(a){console.log("Authentication failed: "),console.log(a),e.reject(a)}),e.promise},r=[],s=function(a){r.push(a)},t=function(){angular.forEach(r,function(a){a()})},u=function(c){var d=b.defer();return a.put("/api/v1/password",c).then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},v=function(c){var d=b.defer();return a.put("/api/v1/firstPassword",c).then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},w=function(c){var d=b.defer();return a.post("/api/v1/forgotPasswordRequest",c).then(function(a){d.resolve(a.data)},function(a){d.reject(a)}),d.promise},x=function(){if(f.hasOwnProperty("id")){var a=b.defer();return a.resolve(f),a.promise}return j()};return{login:q,logout:p,getMe:j,getLastMe:i,getUser:n,registerObserverPersonalCover:s,notifyPersonalCoverObservers:t,setScenarioId:g,getScenarioId:h,changePassword:u,changeFirstPassword:v,updateMe:o,confirmRegisterTeacher:l,forgotPasswordRequest:w,deleteRegisterTeacher:m,getUserByEmail:k,getMeForPermission:x}}]);